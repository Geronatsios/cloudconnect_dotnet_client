@model IEnumerable<WebDemo.Models.CollectionModel>
@{
    ViewBag.Title = "Collection";
}
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12">
            <div class="page-header">
                @if (String.IsNullOrEmpty(@ViewBag.Imei))
                {
                    <div class="alert alert-error">
                        This asset does not exist !
                    </div>
                }
                else
                {
                    <h1>
                        Tracking Data for @ViewBag.Imei <small>@(ViewBag.Date > DateTime.MinValue ? ViewBag.Date.ToString("yyyy/MM/dd") : "")</small></h1>
                
                    if (ViewBag.Date > DateTime.MinValue)
                    {
                    <a class = "btn btn-primary"  href="@Url.Action("Index"
                , new { asset = ViewBag.Imei, year = ViewBag.Date.AddDays(-1).Year, month = ViewBag.Date.AddDays(-1).Month, Day = ViewBag.Date.AddDays(-1).Day })">
                        <i class='icon-arrow-left icon-white'></i>Previous Day</a>
                    }
                    if (ViewBag.Date < DateTime.Today)
                    {
                    <a class="btn btn-primary"  href="@Url.Action("Index", new { asset = ViewBag.Imei, year = ViewBag.Date.AddDays(1).Year, month = ViewBag.Date.AddDays(1).Month, Day = ViewBag.Date.AddDays(1).Day })">
                        Next Day <i class='icon-arrow-right icon-white'></i></a>
                    }
                
                    <a class="btn btn-success"  href="@Url.Action("csvexport", new { asset = ViewBag.Imei, datekey = ViewBag.DateKey })">
                        <i class='icon-download-alt icon-white'></i>Export to Csv</a>
                    if (User.IsInRole("Admin"))
                    {
                    <a class="btn btn-danger pull-right"  href="@Url.Action("Drop", new { asset = ViewBag.Imei, year = ViewBag.Date.Year, month = ViewBag.Date.Month, Day = ViewBag.Date.Day })">
                        <i class='icon-remove icon-white'></i>Remove current data</a>
                    }
                }
            </div>
            <table class="table table-striped table-bordered table-hover table-condensed">
                <tr>
                    <th>
                        Name
                    </th>
                    <th>
                        Asset
                    </th>
                    <th>
                        Id_str
                    </th>
                    <th>
                        Start_at
                    </th>
                    <th>
                        Stop_at
                    </th>
                    <th>
                    </th>
                </tr>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.DeviceID)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Id_str)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Start_at)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Stop_at)
                        </td>
                        <td>
                            @Html.ActionLink("Details", "Details", new { id = item.Id })
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>
